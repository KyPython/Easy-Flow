name: Dev Branch â€” Quick Check (Non-Blocking)

on:
  push:
    branches: [dev]
    # Skip on large file changes to avoid timeouts
    paths-ignore:
      - '**.md'
      - 'docs/**'
      - '**.log'
      - 'node_modules/**'
  workflow_dispatch:

# This workflow is intentionally lightweight - just verify code compiles
# Full checks run on schedule and PRs, not blocking dev pushes

jobs:
  quick-check:
    runs-on: ubuntu-latest
    timeout-minutes: 5  # Fast timeout - should complete in 2-3 minutes
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          clean: true
          fetch-depth: 1  # Shallow clone for speed

      - name: Set up Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: "npm"
          cache-dependency-path: |
            package-lock.json
            rpa-system/package-lock.json
            rpa-system/rpa-dashboard/package-lock.json
            rpa-system/backend/package-lock.json

      - name: Quick syntax check
        run: |
          echo "ğŸ” Quick syntax check (non-blocking for dev branch)"
          # Just verify Node.js files parse correctly
          if [ -d "rpa-system/backend" ]; then
            cd rpa-system/backend
            node --check routes/*.js services/*.js 2>/dev/null || echo "âš ï¸ Syntax issues found. ACTION: Check your JS files for syntax errors."
            cd ../..
          fi
        continue-on-error: true

      - name: Verify builds compile
        run: |
          echo "ğŸ” Quick build verification (non-blocking)"
          # Frontend build check (skip if no changes)
          if [ -f "rpa-system/rpa-dashboard/package.json" ]; then
            cd rpa-system/rpa-dashboard
            timeout 120 npm run build 2>&1 | head -50 || echo "âš ï¸ Build failed. ACTION: Run 'npm run build' in rpa-dashboard locally to fix."
            cd ../..
          fi
        continue-on-error: true

      - name: Success
        run: |
          echo "âœ… Quick check complete - dev branch push allowed"
          echo "ğŸ“ Full validation runs on schedule and PRs (not blocking pushes)"

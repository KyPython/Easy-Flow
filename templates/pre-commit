#!/usr/bin/env sh
# Husky pre-commit hook template
set -euo pipefail

echo "[easyflow] pre-commit checks"

# Project-specific pre-commit script, if present
if [ -x scripts/pre-commit.sh ]; then
  scripts/pre-commit.sh
fi

# Terraform formatting (if terraform files present)
if command -v terraform >/dev/null 2>&1; then
  if ls -1 **/*.tf >/dev/null 2>&1; then
    terraform fmt -recursive || { echo "[easyflow] terraform fmt failed"; exit 1; }
  fi
fi

# Node lint
if [ -f package.json ] && command -v npm >/dev/null 2>&1; then
  npm run -s lint || { echo "[easyflow] lint failed"; exit 1; }
fi

echo "[easyflow] pre-commit passed"
